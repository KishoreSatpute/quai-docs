"use strict";(self.webpackChunkquai_docs=self.webpackChunkquai_docs||[]).push([[2653],{3905:(e,n,t)=>{t.d(n,{Zo:()=>d,kt:()=>g});var a=t(7294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,a,i=function(e,n){if(null==e)return{};var t,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var u=a.createContext({}),s=function(e){var n=a.useContext(u),t=n;return e&&(t="function"==typeof e?e(n):r(r({},n),e)),t},d=function(e){var n=s(e.components);return a.createElement(u.Provider,{value:n},e.children)},p="mdxType",c={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},m=a.forwardRef((function(e,n){var t=e.components,i=e.mdxType,o=e.originalType,u=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),p=s(t),m=i,g=p["".concat(u,".").concat(m)]||p[m]||c[m]||o;return t?a.createElement(g,r(r({ref:n},d),{},{components:t})):a.createElement(g,r({ref:n},d))}));function g(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var o=t.length,r=new Array(o);r[0]=m;var l={};for(var u in n)hasOwnProperty.call(n,u)&&(l[u]=n[u]);l.originalType=e,l[p]="string"==typeof e?e:i,r[1]=l;for(var s=2;s<o;s++)r[s]=t[s];return a.createElement.apply(null,r)}return a.createElement.apply(null,t)}m.displayName="MDXCreateElement"},8360:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>u,contentTitle:()=>r,default:()=>c,frontMatter:()=>o,metadata:()=>l,toc:()=>s});var a=t(7462),i=(t(7294),t(3905));const o={title:"Run A Node",description:"Overview of the implemenation of a Quai Network node.",slug:"/run-a-node",hide_table_of_contents:!1,sidebar_position:1},r="Run A Node",l={unversionedId:"participate/run-quai/node-overview/run-a-node",id:"participate/run-quai/node-overview/run-a-node",title:"Run A Node",description:"Overview of the implemenation of a Quai Network node.",source:"@site/docs/participate/run-quai/node-overview/run-a-node.md",sourceDirName:"participate/run-quai/node-overview",slug:"/run-a-node",permalink:"/docs/run-a-node",draft:!1,editUrl:"https://github.com/dominant-strategies/quai-docs/tree/main/docs/participate/run-quai/node-overview/run-a-node.md",tags:[],version:"current",lastUpdatedBy:"Juuddi",lastUpdatedAt:1692647052,formattedLastUpdatedAt:"Aug 21, 2023",sidebarPosition:1,frontMatter:{title:"Run A Node",description:"Overview of the implemenation of a Quai Network node.",slug:"/run-a-node",hide_table_of_contents:!1,sidebar_position:1},sidebar:"participateSidebar",previous:{title:"Node Overview",permalink:"/docs/node-overview"},next:{title:"Miner Overview",permalink:"/docs/miner-overview"}},u={},s=[{value:"Environment Setup",id:"environment-setup",level:2},{value:"Install Dependencies",id:"install-dependencies",level:3},{value:"Install go-quai",id:"install-go-quai",level:3},{value:"Client Configuration",id:"client-configuration",level:2},{value:"Running the Client",id:"running-the-client",level:2},{value:"Build",id:"build",level:3},{value:"Start",id:"start",level:3},{value:"Run a Global Node",id:"run-a-global-node",level:4},{value:"Run a Base Node",id:"run-a-base-node",level:4},{value:"Verify",id:"verify",level:3},{value:"Stop",id:"stop",level:3},{value:"Maintain",id:"maintain",level:3},{value:"Updating",id:"updating",level:4}],d={toc:s},p="wrapper";function c(e){let{components:n,...o}=e;return(0,i.kt)(p,(0,a.Z)({},d,o,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"run-a-node"},"Run A Node"),(0,i.kt)("h2",{id:"environment-setup"},"Environment Setup"),(0,i.kt)("p",null,"Here, we'll be installing and running go-quai, the Go implementation of a Quai Network Node."),(0,i.kt)("h3",{id:"install-dependencies"},"Install Dependencies"),(0,i.kt)("p",null,"To run an instage of go-quai, you'll need to install a few dependencies. The following dependencies are required to run a node:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Golang v1.21.0 or higher",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://snapcraft.io/install/go/ubuntu#install"},"Linux Installation")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://formulae.brew.sh/formula/go"},"MacOS Installation")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://medium.com/@benzbraunstein/how-to-install-and-setup-golang-development-under-wsl-2-4b8ca7720374"},"Windows Installation")))),(0,i.kt)("li",{parentName:"ul"},"C Compiler",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://itsfoss.com/build-essential-ubuntu/"},"Linux Installation")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://formulae.brew.sh/formula/make"},"MacOS Installation")),(0,i.kt)("li",{parentName:"ul"},"Windows Installation (same as Linux with WSL2)")))),(0,i.kt)("h3",{id:"install-go-quai"},"Install go-quai"),(0,i.kt)("p",null,"Now that you've installed the base dependencies, we can go ahead and clone the\n",(0,i.kt)("a",{parentName:"p",href:"https://github.com/dominant-strategies/go-quai"},"go-quai repo"),"."),(0,i.kt)("p",null,"To clone the go-quai repo and navigate to it, run the following commands:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"git clone https://github.com/dominant-strategies/go-quai\ncd go-quai\n")),(0,i.kt)("p",null,"This will install the main branch to your local machine."),(0,i.kt)("h2",{id:"client-configuration"},"Client Configuration"),(0,i.kt)("p",null,"After you've successfully installed go-quai, you'll need to configure your node. The ",(0,i.kt)("inlineCode",{parentName:"p"},"network.env.dist")," file\nis a boilerplate node configuration file. Copy the boilerplate file into a new file named ",(0,i.kt)("inlineCode",{parentName:"p"},"network.env")," so\nthat we can create our own custom config."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"cp network.env.dist network.env\n")),(0,i.kt)("p",null,"The network.env file houses a number of important parameters that we'll need to configure to run our node. The\nvariables listed below will need to be set correctly for every experience level."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"COINBASE"),": the address in each chain (location) that mining rewards are paid to. Note there is one coinbase\naddress per shard."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"NETWORK"),": the network (testnet, devnet, etc.) your node is running on.")),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"This file also contains a number of more advanced parameters that will not be covered in this article.")),(0,i.kt)("p",null,"Open the config file in your favorite text editor or IDE, such as VSCode. If you are mining, replace the dummy\ncoinbase addresses with your own for the chains that you intend to mine. If you do not do this, your mining\nrewards will not be sent to your ",(0,i.kt)("em",{parentName:"p"},"addresses"),"."),(0,i.kt)("p",null,"Set the ",(0,i.kt)("inlineCode",{parentName:"p"},"NETWORK")," variable to the network you plan on running. Available network options can be found in the\n",(0,i.kt)("a",{parentName:"p",href:"/docs/develop"},"network specifications page"),"."),(0,i.kt)("h2",{id:"running-the-client"},"Running the Client"),(0,i.kt)("h3",{id:"build"},"Build"),(0,i.kt)("p",null,"To start the node, we first need to build the source. You can build via Makefile by running the following command:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"make go-quai\n")),(0,i.kt)("h3",{id:"start"},"Start"),(0,i.kt)("p",null,"//TODO: DECIDE ON NODE NAMES (GLOBAL? BASE? SLICE? WATCHER?)\nNow that we've built the source, we need to decide which type of node to run. As detailed in the ",(0,i.kt)("a",{parentName:"p",href:"/docs/node-overview"},"Node Overview page"),", users currently can opt for either a global or base node depending on individual use case and hardware."),(0,i.kt)("h4",{id:"run-a-global-node"},"Run a Global Node"),(0,i.kt)("p",null,"Global nodes validate every chain within Quai Network. To spin up and start a global node, simply run:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"make run-all\n")),(0,i.kt)("h4",{id:"run-a-base-node"},"Run a Base Node"),(0,i.kt)("p",null,'Base nodes run what is called a "slice" of Quai Network. A slice is a subset of the network that validates prime, one region, and one zone chain. In the codebase, a slice is identified by its region and zone index. Region and zone indices are 0-indexed and range from 0-2.'),(0,i.kt)("p",null,"To spin up a slice node, select a region and zone index and run:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"make run-slice REGION=0 ZONE=0\n")),(0,i.kt)("p",null,"Node operators should self-select the slice least latent to them, in order to minimize their uncle rate and maximize network bandwidth. Providing an initial suggestion for geographic organization will expidite the minimization of latency."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Quai Network Geographic Organization",src:t(1478).Z,width:"3871",height:"2209"})),(0,i.kt)("h3",{id:"verify"},"Verify"),(0,i.kt)("p",null,"Starting a node will run all instances of go-quai in the background and create a directory named nodelogs. Outputs from the node will be piped to a context specific .log file inside of nodelogs. To view the last 100 lines of log output for a specific location, use:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"tail -f 100 nodelogs/prime.log\n# OR\ntail -f 100 nodelogs/region-2.log\n# OR\ntail -f 100 nodelogs/zone-0-0.log\n")),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"If you're running a base node, logs will only populate in the contexts the node is running.")),(0,i.kt)("p",null,"Checking the node logs output is the best way to verify that your full node is running correctly. You can also easily view node logs in your favorite IDE, we recommend using this method."),(0,i.kt)("p",null,"The outputs of a node that is running correctly should look like:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"INFO [01-30|19:55:15.397] Starting Quai 0.1.0-pre.0 on local testnet\nINFO [01-30|19:55:15.414] Maximum peer count                       ETH=50 total=50\nWARN [01-30|19:55:15.460] Disable transaction unindexing for archive node\nINFO [01-30|19:55:15.460] Enabling recording of key preimages since archive mode is used\nINFO [01-30|19:55:15.460] Set global gas cap                       cap=50,000,000\nINFO [01-30|19:55:15.460] Allocated trie memory caches             clean=307.00MiB dirty=0.00B\nINFO [01-30|19:55:15.461] Allocated cache and file handles         database=/Users/user/Library/Quai/local/zone-0-0/quai/chaindata cache=512.00MiB handles=5120\nINFO [01-30|19:55:17.727] Opened ancient database                  database=/Users/user/Library/Quai/local/zone-0-0/quai/chaindata/ancient readonly=false\nINFO [01-30|19:55:17.728] Writing custom genesis block\n")),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Depending on what your node is currently doing, your logs may not look exactly the same as above.")),(0,i.kt)("h3",{id:"stop"},"Stop"),(0,i.kt)("p",null,"Stopping your node should be done any time you make changes to your config file or prior to shutting your machine down. A node instance can be terminated by running:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"make stop\n")),(0,i.kt)("p",null,"This will kill all instances of go-quai on your machine. This can sometimes take a few seconds to complete."),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"If you're running a miner, running ",(0,i.kt)("inlineCode",{parentName:"p"},"make stop")," will not work. You must kill the miner process prior to stopping the node.")),(0,i.kt)("h3",{id:"maintain"},"Maintain"),(0,i.kt)("p",null,"Making sure your node is running correctly is crucial to both the functionality of any dependent infrastructure and the network as a whole."),(0,i.kt)("h4",{id:"updating"},"Updating"),(0,i.kt)("p",null,"To update a node, first ",(0,i.kt)("strong",{parentName:"p"},"make sure to kill all instances of go-quai")," using the above stop command."),(0,i.kt)("p",null,"After stopping the node, you should pull any updated code using:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"git pull origin main\n")),(0,i.kt)("p",null,"and rebuild the source using:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"make go-quai\n")),(0,i.kt)("p",null,"After pulling any new code and rebuilding the source, you can safely restart the node and continue running."),(0,i.kt)("admonition",{type:"warning"},(0,i.kt)("p",{parentName:"admonition"},"Initiating the node update process while the node or manager are currently running could cause issues. Make sure to stop all processes before updating.")))}c.isMDXComponent=!0},1478:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/LatencyMap-1097ed3be692635cc455c422dc38dc86.png"}}]);